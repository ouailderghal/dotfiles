#!/usr/bin/env python

from pathlib import Path
import pathlib


def check_stow() -> bool:
    from shutil import which
    return which('stow') is not None


def stow(name: str, target: pathlib.Path) -> None:
    """
    Deploy config directory using GNU stow

    :param name: config name
    :param target: path to deploy the config
    """
    from os import system
    target.mkdir(parents=True, exist_ok=True)
    command = f'stow {name} -t {target}'
    system(command)


class Deployer:
    home = Path.home()
    config = home.joinpath('.config')

    dotfiles = [
        ('alacritty', config.joinpath('alacritty')),
        ('awesome', config.joinpath('awesome')),
        ('bash', home),
        ('emacs', home.joinpath('.emacs.d')),
        ('i3', config.joinpath('i3')),
        ('i3status', config.joinpath('i3status')),
        ('neofetch', config.joinpath('neofetch')),
        ('nvim', config.joinpath('nvim')),
        ('tmux', config.joinpath('tmux')),
        ('xmodmap', home)
    ]

    def deploy(self, config: str = 'all'):
        for name, target in self.dotfiles:
            self.stow(name, target)
            break


def main() -> None:
    d = Deployer()
    d.deploy()


if __name__ == '__main__':
    main()
